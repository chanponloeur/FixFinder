<!DOCTYPE html>
<html lang="km">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../asstes/img/Landing-page/title-icon.png">
    <title>FixFinder - ស្វែងរកសេវាកម្មជិតអ្នក</title>
    <link rel="stylesheet" href="../asstes/css/bootstrap.css">
    <link rel="stylesheet" href="../asstes/css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Khmer:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

</head>

<body>
    <!-- Header -->
    <header>
        <!-- navbar-top -->
        <nav class="navbar-top py-2">
            <div class="container">
                <div class="row justify-content-between">
                    <div class="col-lg-8 d-none d-lg-block">
                        <div class="d-flex align-items-center ps-4">
                            <div class="me-3">
                                <i class="ri-phone-line fs-5 "></i>
                                <span class=" fs-6">ទំនាក់ទំនង:</span>
                                <a href="#" class="text-decoration-none">+1 (234) 567 890</a>
                            </div>
                            <div>
                                <i class="ri-mail-line fs-5 "></i>
                                <span class=" fs-6">FixFinder@gmail.com</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- navbar-center -->
        <nav class="navbar navbar-center navbar-expand-lg">
            <div class="container-lg justify-content-between align-items-center ">
                <div>
                    <a class="navbar-brand fw-bold" href="home.html">
                        <img src="../asstes/img/Landing-page/logo-2.png" alt="">
                    </a>
                </div>
                <div>
                    <form class="d-flex search-form d-none d-lg-block" role="search">
                        <input class="form-control me-2 p-2" type="search" placeholder="ស្វែករកសេវាកម្ម"
                            aria-label="Search" />
                        <button class="btn btn-outline-success bg-primary text-white" type="submit"><i
                                class="ri-search-line"></i></button>
                    </form>
                </div>
                <div class="d-flex align-items-center">
                    <i class="ri-search-line me-3 d-lg-none d-block fs-3" data-bs-toggle="collapse"
                        data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true"
                        aria-controls="panelsStayOpen-collapseOne"></i>
                    <div class="dropdown">
                        <a href="notification.html" class="nav-link position-relative">
                            <i class="ri-notification-2-line fs-4 me-3"></i>
                            <span
                                class="position-absolute top-0 start-50 translate-middle badge rounded-circle p-1 bg-danger">
                                3+
                            </span>
                        </a>
                        <ul class="dropdown-menu dropdown-notification ">
                            <div class="d-flex px-4 pt-2 align-items-center justify-content-between">
                                <div class="d-flex align-items-center">
                                    <i class="ri-notification-2-line fs-5 me-3"></i>
                                    <h5 class="fs-5 m-0 ">ការជូនដំណឹង</h5>
                                </div>
                            </div>
                            <hr class="mb-0">
                            <li><a class="dropdown-item px-4 py-2" href="#">
                                    <span class="fw-bold text-primary fs-6 pb-3">ថ្មីៗនេះ</span>
                                    <div>
                                        <span class="fw-bold">ការកក់បានទទួល:</span>
                                        <p class="fs-6 m-0">ការកក់សេវារបស់អ្នកត្រូវបានទទួល...</p>
                                    </div>
                                </a></li>
                            <hr class="m-0">
                            <li><a class="dropdown-item px-4 py-2" href="#">
                                    <span class="fw-bold text-primary fs-6">ថ្ងៃនេះ</span>
                                    <div>
                                        <span class="fw-bold ">ការជួសជុលបានបញ្ចប់</span>
                                        <p class="fs-6 m-0">សេវាការជួសជុលរបស់អ្នកត្រូវបានបញ្ចប់...</p>
                                    </div>
                                </a></li>
                            <hr class="m-0">
                            <li><a class="dropdown-item px-4 py-2" href="#">
                                    <span class="fw-bold text-primary fs-6">ម្សិលមិញ</span>
                                    <div>
                                        <span class="fw-bold">ការផ្តល់ជូនពិសេស:</span>
                                        <p class="fs-6 m-0">ការបញ្ចុះតម្លៃ 20% សម្រាប់សេវាការជួស...</p>
                                    </div>
                                </a></li>
                            <hr class="m-0">
                            <div class="w-100 d-flex justify-content-center py-2">
                                <div> <a href="notification.html"
                                        class="btn btn-outline-primary rounded-pill hvr-shutter-in-horizontal overflow-hidden">​​មើលទាំងអស់</a>
                                </div>
                            </div>
                        </ul>
                    </div>
                    <div class="dropdown">
                        <a class="nav-link position-relative" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            <div class="profile-image-container me-3">
                                <img src="../asstes/img/Landing-page/user-profile.png" class="img-fluid profile-image"
                                    alt="">

                            </div>
                            <span
                                class="position-absolute top-0 start-75 translate-middle p-2 bg-danger border border-light rounded-circle">
                                <span class="visually-hidden">New alerts</span>
                            </span>
                        </a>
                        <ul class="dropdown-menu dropdown-profile">
                            <li><a class="dropdown-item " href="history_user.html"><i class="ri-user-3-line"></i>
                                    គណនី</a></li>
                            <li><a class="dropdown-item" href="../index.html"><i class="ri-arrow-right-line"></i>

                                    ចាកចេញ</a></li>

                        </ul>
                    </div>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                </div>
            </div>
        </nav>

        <div class="bg-body-tertiary m-auto">
            <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse">
                <div class="py-3 d-flex justify-content-center d-lg-none d-block">
                    <form class="d-flex search-form" role="search">
                        <input class="form-control me-2 p-2" type="search" placeholder="ស្វែករកសេវាកម្ម"
                            aria-label="Search" />
                        <button class="btn btn-outline-success bg-primary text-white" type="submit"><i
                                class="ri-search-line"></i></button>
                    </form>
                </div>
            </div>
        </div>
        <div class="collapse navbar-collapse px-3" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0  flex-column">
                <li class="nav-item ">
                    <a class="nav-link active " aria-current="page" href="home.html"><i class="ri-home-gear-line"></i>
                        ទំព័រដើម</a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link " href="professional_list.html"><i class="ri-file-list-3-line"></i>
                        បញ្ជីអ្នកជំនាញ </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="service.html"><i class="ri-tools-fill"></i> សេវាកម្ម</a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="history_bolt.html"><i class="ri-chat-history-line"></i> ប្រវត្តិការងារ</a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="help.html"><i class="ri-question-line"></i> ជំនួយ</a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="about_us.html"><i class="ri-team-line"></i> អំពីពួកយើង</a>
                </li>
                <li class="nav-item ">
                    <a class="nav-link" href="contact_us.html"><i class="ri-phone-line"></i> ទំនាក់ទំនង</a>
                </li>
            </ul>
        </div>

        <!-- navbar-bottom -->
        <nav class="navbar navbar-bottom navbar-expand-lg bg-primary d-none d-lg-block" data-bs-theme="dark">
            <div class="container">
                <div class="collapse navbar-collapse">
                    <div class="collapse navbar-collapse">
                        <ul class="navbar-nav mx-auto mb-2 mb-lg-0 ">
                            <li class="nav-item ">
                                <a class="nav-link hvr-underline-from-center" aria-current="page" href="home.html"><i
                                        class="ri-home-gear-line"></i>
                                    ទំព័រដើម</a>
                            </li>
                            <li class="nav-item ">
                                <a class="nav-link hvr-underline-from-center" href="professional_list.html"><i
                                        class="ri-file-list-3-line"></i> បញ្ជីអ្នកជំនាញ </a>
                            </li>
                            <li class="nav-item ">
                                <a class="nav-link active" href="service.html"><i class="ri-tools-fill"></i>
                                    សេវាកម្ម</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link hvr-underline-from-center" href="history_bolt.html"><i
                                        class="ri-chat-history-line"></i> ប្រវត្តិការងារ</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link hvr-underline-from-center" href="help.html"><i
                                        class="ri-question-line"></i>
                                    ជំនួយ</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link hvr-underline-from-center" href="about_us.html"><i
                                        class="ri-team-line"></i>
                                    អំពីពួកយើង</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link hvr-underline-from-center" href="contact_us.html"><i
                                        class="ri-phone-line"></i>
                                    ទំនាក់ទំនង</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="service-search py-5">
            <div class="container">
                <div class="row">
                    <!-- Search and Filters -->
                    <div class="col-lg-4">
                        <!-- Main Search -->
                        <div class="search-container">
                            <h5 class="mb-3">
                                <i class="fas fa-search me-2 text-primary"></i>
                                ស្វែងរកសេវាកម្ម
                            </h5>

                            <div class="mb-3">
                                <input type="text" class="form-control search-input"
                                    placeholder="វាយបញ្ចូលប្រភេទសេវាកម្ម..." id="serviceSearch">
                            </div>

                            <div class="mb-3">
                                <input type="text" class="form-control search-input" placeholder="ទីតាំងរបស់អ្នក..."
                                    id="locationSearch">
                            </div>

                            <div class="d-grid gap-2">
                                <button class="btn btn-search" onclick="searchServices()">
                                    <i class="fas fa-search me-2"></i>ស្វែងរក
                                </button>
                                <button class="btn location-btn" onclick="getCurrentLocation()">
                                    <i class="fas fa-crosshairs me-2"></i>ប្រើទីតាំងបច្ចុប្បន្ន
                                </button>
                            </div>
                        </div>

                        <!-- Service Categories -->
                        <div class="filter-section">
                            <h5 class="mb-3">
                                <i class="fas fa-th-large me-2 text-primary"></i>
                                ប្រភេទសេវាកម្ម
                            </h5>

                            <div class="row g-3">
                                <div class="col-6">
                                    <div class="service-category" onclick="selectCategory('electric')">
                                        <div class="service-icon icon-electric">
                                            <i class="fas fa-bolt"></i>
                                        </div>
                                        <h6 class="mb-0">អគ្គិសនី</h6>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="service-category" onclick="selectCategory('plumbing')">
                                        <div class="service-icon icon-plumbing">
                                            <i class="fas fa-wrench"></i>
                                        </div>
                                        <h6 class="mb-0">ទឹកប្រាក់</h6>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="service-category" onclick="selectCategory('mechanic')">
                                        <div class="service-icon icon-mechanic">
                                            <i class="fas fa-cogs"></i>
                                        </div>
                                        <h6 class="mb-0">មេកានិក</h6>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="service-category" onclick="selectCategory('construction')">
                                        <div class="service-icon icon-construction">
                                            <i class="fas fa-hard-hat"></i>
                                        </div>
                                        <h6 class="mb-0">សំណង់</h6>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="service-category" onclick="selectCategory('cleaning')">
                                        <div class="service-icon icon-cleaning">
                                            <i class="fas fa-broom"></i>
                                        </div>
                                        <h6 class="mb-0">អនាម័យ</h6>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="service-category" onclick="selectCategory('beauty')">
                                        <div class="service-icon icon-beauty">
                                            <i class="fas fa-cut"></i>
                                        </div>
                                        <h6 class="mb-0">សម្រស់</h6>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Filters -->
                        <div class="filter-section">
                            <h5 class="mb-3">
                                <i class="fas fa-filter me-2 text-primary"></i>
                                តម្រងរហ័ស
                            </h5>

                            <div class="quick-filters">
                                <button class="quick-filter-btn active" onclick="toggleFilter(this, 'nearest')">
                                    <i class="fas fa-map-marker-alt me-1"></i>ជិតបំផុត
                                </button>
                                <button class="quick-filter-btn" onclick="toggleFilter(this, 'rating')">
                                    <i class="fas fa-star me-1"></i>ពេញនិយម
                                </button>
                                <button class="quick-filter-btn" onclick="toggleFilter(this, 'price')">
                                    <i class="fas fa-dollar-sign me-1"></i>តម្លៃសម
                                </button>
                                <button class="quick-filter-btn" onclick="toggleFilter(this, 'available')">
                                    <i class="fas fa-clock me-1"></i>ទំនេរ
                                </button>
                            </div>

                            <div class="row g-2 mt-2">
                                <div class="col-6">
                                    <select class="form-select" id="distanceFilter">
                                        <option value="">ចម្ងាយ</option>
                                        <option value="1">
                                            < 1 km</option>
                                        <option value="5">
                                            < 5 km</option>
                                        <option value="10">
                                            < 10 km</option>
                                    </select>
                                </div>
                                <div class="col-6">
                                    <select class="form-select" id="priceFilter">
                                        <option value="">តម្លៃ</option>
                                        <option value="low">$5 - $20</option>
                                        <option value="mid">$20 - $50</option>
                                        <option value="high">$50+</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Results and Map -->
                    <div class="col-lg-8">
                        <!-- Map -->
                        <div class="map-container mb-4">
                            <div class="map-placeholder">
                                <div class="text-center">
                                    <i class="fas fa-map-marked-alt fa-3x mb-3 text-muted"></i>
                                    <p>ផែនទីទីតាំងជាងនិងសេវាកម្មនៅជិតអ្នក</p>
                                    <button class="btn btn-primary btn-sm" onclick="initializeMap()">
                                        <i class="fas fa-map me-1"></i>បើកផែនទី
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Search Results -->
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0">
                                <i class="fas fa-list me-2 text-primary"></i>
                                លទ្ធផលស្វែងរក (<span id="resultCount">12</span>)
                            </h5>
                            <div class="d-flex gap-2">
                                <select class="form-select form-select-sm" style="width: auto;" id="sortResults">
                                    <option value="distance">តម្រៀបតាមចម្ងាយ</option>
                                    <option value="rating">តម្រៀបតាមពិន្ទុ</option>
                                </select>
                                <button class="btn btn-outline-primary btn-sm" onclick="toggleView()">
                                    <i class="fas fa-th-large"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Loading Spinner -->
                        <div class="loading-spinner" id="loadingSpinner">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">កំពុងស្វែងរក...</span>
                            </div>
                            <p class="mt-3">កំពុងស្វែងរកជាងជំនាញនៅជិតអ្នក...</p>
                        </div>

                        <!-- Results List -->
                        <div id="resultsContainer">
                            <!-- Professional Card 1 -->
                            <div class="professional-card">
                                <div class="row">
                                    <div class="col-md-3 text-center mb-3 mb-md-0">
                                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face"
                                            alt="Professional" class="professional-avatar">
                                        <div class="mt-2">
                                            <span class="distance-badge">0.5 km</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h5 class="mb-1">លោក សុភា</h5>
                                        <p class="text-muted mb-2">
                                            <i class="fas fa-bolt me-1 text-warning"></i>
                                            ជាងអគ្គិសនីជំនាញ
                                        </p>
                                        <div class="rating mb-2">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <span class="ms-1">(4.9) - 127 ការវាយតម្លៃ</span>
                                        </div>
                                        <p class="text-muted small mb-2">
                                            <i class="fas fa-map-marker-alt me-1"></i>
                                            ផ្ទះលេខ 123 ផ្លូវមហាវិថី...
                                        </p>
                                        <div class="d-flex gap-1 mb-2">
                                            <span class="badge bg-light text-dark">ជួសជុលភ្លើង</span>
                                            <span class="badge bg-light text-dark">ដំឡើង</span>
                                            <span class="badge bg-light text-dark">24/7</span>
                                        </div>
                                    </div>
                                    <div class="col-md-3 text-center">
                                        <div class="d-grid gap-2">
                                            <a href="contact_us.html" class="btn btn-primary">
                                                <i class="fas fa-phone me-1"></i>ទំនាក់ទំនង
                                            </a>
                                            <a href="profile_professional.html" class="btn btn-primary">
                                                <i class="fas fa-info-circle me-1"></i>ព័ត៌មានលម្អិត
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Professional Card 2 -->
                            <div class="professional-card">
                                <div class="row">
                                    <div class="col-md-3 text-center mb-3 mb-md-0">
                                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face"
                                            alt="Professional" class="professional-avatar">
                                        <div class="mt-2">
                                            <span class="distance-badge">1.2 km</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h5 class="mb-1">លោកស្រី ចន្ទា</h5>
                                        <p class="text-muted mb-2">
                                            <i class="fas fa-wrench me-1 text-info"></i>
                                            ជាងទឹកប្រាក់
                                        </p>
                                        <div class="rating mb-2">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="far fa-star"></i>
                                            <span class="ms-1">(4.7) - 89 ការវាយតម្លៃ</span>
                                        </div>
                                        <p class="text-muted small mb-2">
                                            <i class="fas fa-map-marker-alt me-1"></i>
                                            ផ្ទះលេខ 456 ផ្លូវជាតិ...
                                        </p>
                                        <div class="d-flex gap-1 mb-2">
                                            <span class="badge bg-light text-dark">ជួសជុលទឹក</span>
                                            <span class="badge bg-light text-dark">ដំឡើងថ្មី</span>
                                        </div>
                                    </div>
                                    <div class="col-md-3 text-center">
                                        <div class="d-grid gap-2">
                                            <a href="contact_us.html" class="btn btn-primary">
                                                <i class="fas fa-phone me-1"></i>ទំនាក់ទំនង
                                            </a>
                                            <a href="profile_professional.html" class="btn btn-primary">
                                                <i class="fas fa-info-circle me-1"></i>ព័ត៌មានលម្អិត
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Professional Card 3 -->
                            <div class="professional-card">
                                <div class="row">
                                    <div class="col-md-3 text-center mb-3 mb-md-0">
                                        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face"
                                            alt="Professional" class="professional-avatar">
                                        <div class="mt-2">
                                            <span class="distance-badge">2.1 km</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <h5 class="mb-1">លោក វណ្ណ</h5>
                                        <p class="text-muted mb-2">
                                            <i class="fas fa-cogs me-1 text-danger"></i>
                                            មេកានិកម៉ូតូ
                                        </p>
                                        <div class="rating mb-2">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <span class="ms-1">(5.0) - 203 ការវាយតម្លៃ</span>
                                        </div>
                                        <p class="text-muted small mb-2">
                                            <i class="fas fa-map-marker-alt me-1"></i>
                                            ផ្ទះលេខ 789 ផ្លូវលេខ...
                                        </p>
                                        <div class="d-flex gap-1 mb-2">
                                            <span class="badge bg-light text-dark">ជួសម៉ូតូ</span>
                                            <span class="badge bg-light text-dark">រថយន្ត</span>
                                            <span class="badge bg-light text-dark">ទំនេរ24ម៉ោង</span>
                                        </div>
                                    </div>
                                    <div class="col-md-3 text-center">
                                        <div class="d-grid gap-2">
                                            <a href="contact_us.html" class="btn btn-primary">
                                                <i class="fas fa-phone me-1"></i>ទំនាក់ទំនង
                                            </a>
                                            <a href="profile_professional.html" class="btn btn-primary">
                                                <i class="fas fa-info-circle me-1"></i>ព័ត៌មានលម្អិត
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Load More -->
                        <div class="text-center mt-4">
                            <button class="btn btn-outline-primary btn-lg" onclick="loadMore()">
                                <i class="fas fa-plus me-2"></i>មើលបន្ថែម
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Scripts -->
    <script src="../asstes/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentLocation = null;
        let selectedCategory = null;
        let currentFilters = {
            nearest: true,
            rating: false,
            price: false,
            available: false
        };

        // Get current location using GPS
        function getCurrentLocation() {
            const locationBtn = document.querySelector('.location-btn');
            const originalText = locationBtn.innerHTML;

            locationBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>កំពុងស្វែងរក...';
            locationBtn.disabled = true;

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function (position) {
                        currentLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };

                        // Simulate reverse geocoding
                        document.getElementById('locationSearch').value = 'ទីតាំងបច្ចុប្បន្នរបស់អ្នក';

                        locationBtn.innerHTML = '<i class="fas fa-check me-2"></i>បានកំណត់ទីតាំង';
                        locationBtn.classList.remove('location-btn');
                        locationBtn.classList.add('btn', 'btn-success');

                        // Auto search after getting location
                        setTimeout(() => {
                            searchServices();
                        }, 1000);

                        setTimeout(() => {
                            locationBtn.innerHTML = originalText;
                            locationBtn.classList.remove('btn-success');
                            locationBtn.classList.add('location-btn');
                            locationBtn.disabled = false;
                        }, 3000);
                    },
                    function (error) {
                        locationBtn.innerHTML = '<i class="fas fa-exclamation-triangle me-2"></i>មិនអាចកំណត់បាន';
                        locationBtn.classList.add('btn-warning');

                        setTimeout(() => {
                            locationBtn.innerHTML = originalText;
                            locationBtn.classList.remove('btn-warning');
                            locationBtn.disabled = false;
                        }, 3000);

                        console.error('Error getting location:', error);
                    }
                );
            } else {
                alert('Browser របស់អ្នកមិនគាំទ្រការកំណត់ទីតាំងទេ');
                locationBtn.innerHTML = originalText;
                locationBtn.disabled = false;
            }
        }

        // Search for services
        function searchServices() {
            const searchInput = document.getElementById('serviceSearch').value;
            const locationInput = document.getElementById('locationSearch').value;

            if (!searchInput && !selectedCategory) {
                alert('សូមបញ្ចូលប្រភេទសេវាកម្មដែលអ្នកចង់ស្វែងរក');
                return;
            }

            showLoading();

            // Simulate API call
            setTimeout(() => {
                hideLoading();
                updateResults();
                showNotification('បានរកឃើញ ' + document.getElementById('resultCount').textContent + ' ជាងជំនាញ');
            }, 2000);
        }

        // Select service category
        function selectCategory(category) {
            // Remove active class from all categories
            document.querySelectorAll('.service-category').forEach(cat => {
                cat.classList.remove('active');
            });

            // Add active class to selected category
            event.currentTarget.classList.add('active');
            selectedCategory = category;

            // Update search input based on category
            const categoryNames = {
                'electric': 'ជាងអគ្គិសនី',
                'plumbing': 'ជាងទឹកប្រាក់',
                'mechanic': 'មេកានិក',
                'construction': 'ជាងសំណង់',
                'cleaning': 'សេវាអនាម័យ',
                'beauty': 'សេវាសម្រស់'
            };

            document.getElementById('serviceSearch').value = categoryNames[category] || '';

            // Auto search
            searchServices();
        }

        // Toggle filter
        function toggleFilter(button, filterType) {
            button.classList.toggle('active');
            currentFilters[filterType] = button.classList.contains('active');

            // If this filter is activated, deactivate others (except for multiple selection)
            if (currentFilters[filterType] && filterType !== 'available') {
                Object.keys(currentFilters).forEach(key => {
                    if (key !== filterType && key !== 'available') {
                        currentFilters[key] = false;
                        document.querySelector(`.quick-filter-btn[onclick*="${key}"]`).classList.remove('active');
                    }
                });
            }

            // Re-sort results based on active filter
            searchServices();
        }

        // Show loading spinner
        function showLoading() {
            document.getElementById('loadingSpinner').style.display = 'block';
            document.getElementById('resultsContainer').style.opacity = '0.5';
        }

        // Hide loading spinner
        function hideLoading() {
            document.getElementById('loadingSpinner').style.display = 'none';
            document.getElementById('resultsContainer').style.opacity = '1';
        }

        // Update results (simulate new data)
        function updateResults() {
            const resultCount = Math.floor(Math.random() * 20) + 5;
            document.getElementById('resultCount').textContent = resultCount;

            // Could add more dynamic content here
            animateCards();
        }

        // Animate cards
        function animateCards() {
            const cards = document.querySelectorAll('.professional-card');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';

                setTimeout(() => {
                    card.style.transition = 'all 0.5s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        }

        // Initialize map
        function initializeMap() {
            const mapContainer = document.querySelector('.map-placeholder');
            mapContainer.innerHTML = `
                <div class="d-flex align-items-center justify-content-center h-100">
                    <div class="text-center">
                        <div class="spinner-border text-primary mb-3" role="status"></div>
                        <p>កំពុងផ្ទុកផែនទី...</p>
                    </div>
                </div>
            `;

            setTimeout(() => {
                mapContainer.innerHTML = `
                    <div class="position-relative w-100 h-100">
                        <div class="position-absolute top-50 start-50 translate-middle text-center">
                            <div class="bg-white rounded-circle p-3 shadow mb-2 mx-auto" style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-map-marker-alt text-primary fa-2x"></i>
                            </div>
                            <small class="bg-white px-2 py-1 rounded shadow">ទីតាំងរបស់អ្នក</small>
                        </div>
                        
                        <!-- Simulate nearby professionals on map -->
                        <div class="position-absolute" style="top: 30%; left: 60%;">
                            <div class="bg-success rounded-circle p-2 shadow" style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-user text-white"></i>
                            </div>
                            <small class="bg-white px-2 py-1 rounded shadow position-absolute" style="top: -30px; left: -20px; font-size: 10px;">លោក សុភា</small>
                        </div>
                        
                        <div class="position-absolute" style="top: 70%; left: 40%;">
                            <div class="bg-info rounded-circle p-2 shadow" style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-user text-white"></i>
                            </div>
                            <small class="bg-white px-2 py-1 rounded shadow position-absolute" style="top: -30px; left: -25px; font-size: 10px;">លោកស្រី ចន្ទា</small>
                        </div>
                        
                        <div class="position-absolute" style="top: 20%; left: 25%;">
                            <div class="bg-warning rounded-circle p-2 shadow" style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-user text-white"></i>
                            </div>
                            <small class="bg-white px-2 py-1 rounded shadow position-absolute" style="top: -30px; left: -15px; font-size: 10px;">លោក វណ្ណ</small>
                        </div>
                        
                        <!-- Map controls -->
                        <div class="position-absolute top-0 end-0 m-3">
                            <div class="btn-group-vertical" role="group">
                                <button class="btn btn-light btn-sm border" onclick="zoomIn()">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button class="btn btn-light btn-sm border" onclick="zoomOut()">
                                    <i class="fas fa-minus"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Location button -->
                        <div class="position-absolute bottom-0 end-0 m-3">
                            <button class="btn btn-primary btn-sm" onclick="centerMap()">
                                <i class="fas fa-crosshairs"></i>
                            </button>
                        </div>
                    </div>
                `;
            }, 1500);
        }

        // Map controls
        function zoomIn() {
            showNotification('បានពង្រីកផែនទី');
        }

        function zoomOut() {
            showNotification('បានបន្ថយផែនទី');
        }

        function centerMap() {
            showNotification('ត្រលប់ទៅទីតាំងរបស់អ្នក');
        }

        // Load more results
        function loadMore() {
            showLoading();
            setTimeout(() => {
                hideLoading();
                const currentCount = parseInt(document.getElementById('resultCount').textContent);
                document.getElementById('resultCount').textContent = currentCount + 5;
                showNotification('បានផ្ទុកលទ្ធផលបន្ថែម');
            }, 1000);
        }

        // Toggle view (list/grid)
        function toggleView() {
            const container = document.getElementById('resultsContainer');
            container.classList.toggle('row');

            const cards = container.querySelectorAll('.professional-card');
            cards.forEach(card => {
                if (container.classList.contains('row')) {
                    card.classList.add('col-md-6', 'mb-3');
                } else {
                    card.classList.remove('col-md-6', 'mb-3');
                }
            });
        }

        // Show notification
        function showNotification(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'alert alert-info alert-dismissible fade show position-fixed';
            notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; max-width: 300px;';
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;

            document.body.appendChild(notification);

            // Auto dismiss after 3 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 3000);
        }

        // Sort results
        document.getElementById('sortResults').addEventListener('change', function () {
            const sortBy = this.value;
            showLoading();

            setTimeout(() => {
                hideLoading();
                showNotification(`បានតម្រៀបតាម${sortBy === 'distance' ? 'ចម្ងាយ' : sortBy === 'rating' ? 'ពិន្ទុ' : 'តម្លៃ'}`);
                animateCards();
            }, 1000);
        });

        // Filter change events
        document.getElementById('distanceFilter').addEventListener('change', function () {
            if (this.value) {
                searchServices();
            }
        });

        document.getElementById('priceFilter').addEventListener('change', function () {
            if (this.value) {
                searchServices();
            }
        });

        // Search on Enter key
        document.getElementById('serviceSearch').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                searchServices();
            }
        });

        document.getElementById('locationSearch').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                searchServices();
            }
        });

        // Real-time search suggestions (simulate)
        document.getElementById('serviceSearch').addEventListener('input', function () {
            const query = this.value.toLowerCase();
            if (query.length > 2) {
                // Could show suggestions dropdown here
            }
        });

        // Initialize page
        document.addEventListener('DOMContentLoaded', function () {
            // Initialize map
            initializeMap();

            // Auto-focus search input
            document.getElementById('serviceSearch').focus();

            // Initialize with some default results
            setTimeout(() => {
                animateCards();
            }, 500);
        });

        // Contact professional
        function contactProfessional(name) {
            showNotification(`កំពុងភ្ជាប់ទៅ ${name}...`);

            setTimeout(() => {
                showNotification(`បានភ្ជាប់ដោយជោគជ័យ! ${name} នឹងទំនាក់ទំនងមកអ្នកក្នុងរយៈពេលបីនាទី`);
            }, 2000);
        }

        // Add click events to contact buttons
        document.addEventListener('click', function (e) {
            if (e.target.matches('.btn-contact') || e.target.closest('.btn-contact')) {
                e.preventDefault();
                const card = e.target.closest('.professional-card');
                const name = card.querySelector('h5').textContent;
                contactProfessional(name);
            }
        });
    </script>
</body>

</html>